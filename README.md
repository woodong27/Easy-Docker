# 쉬운 도커

[1. 가상화 기술](#1-가상화-기술)

[2. 이미지와 컨테이너](#이미지와-컨테이너)

[참고 - 명령어 정리(Window)](#명령어-정리)

## 1. 가상화 기술

### 1.1 서버 운영 방식

* 베어메탈(Baremetal)
* 하이버파이저(Hypervisor)
* 컨테이너(Container)

### 1.2 가상화

물리적인 환경에서 논리적인 컴퓨팅 환경을 만든다.

한 대의 컴퓨터에서 여러대의 가상 환경을 만들어서 안정성을 높인다.

각 가상환경(가상 OS)는 사용자가 직접 리소스를 분배할 수 있다.(제한을 걸 수 있다.)

#### 1.2.1 하이버파이저

가상 OS를 만들어서 사용한다.

호스트 OS에서 여러 개의 게스트 OS를 실행한다.

각 프로세스는 OS의 커널에게 시스템 콜을 통해 리소스를 요청한다.

다른 OS끼리는 시스템 콜 명령어가 다르지만, 하이버파이저가 각 커널에 맞도록 번역해준다.

#### 1.2.2 컨테이너

하이퍼바이저 가상화 방식에 비해서 가볍고 빠르다.

리눅스의 LXC를 활용, 리눅스 커널 자체에서 제공하는 격리 기술을 사용한다.

LXC를 통해 만들어진 각 공간을 컨테이너라고 호칭한다.

모든 컨테이너는 호스트 OS의 커널을 공유한다.(하나의 커널을 공유 -> 번역이 필요없다.)

하이퍼바이저 방식에 비해서 오버헤드가 더 적고, 리소스를 효율적으로 사용한다.

#### 1.2.3 도커

컨테이너 플랫폼 : 컨테이너 가상화 도구

컨테이너 엔진, 컨테이너 런타임으로 구성되어 있다.
* 런타임 : 사용자의 요청을 받아서 컨테이너를 관리하는 역할(도커에선 runc 사용)
* 엔진 : 커널과 통신하며 격리된 공간을 만드는 역할 

클라이언트에서 명령을 전달하고, 서버(도커 데몬)에서 결과를 반환

Docker CLI(Command Line Interface)가 명령어를 받아서 API로 변환하여 도커 데몬으로 전달한다.

도커 멍령어는 docker (Management Command) (Command) 로 구성되어 있다.

Management Command는 생략이 가능해서 보통은 docker (Command)의 형태로 사용한다.

Management Command와 Command의 뒤에 --help를 붙여서 매뉴얼을 확인할 수 있다.

## 2. 이미지와 컨테이너

### 2.1 이미지

서비스 실행을 위해서는 Config가 필요하다.

Config : OS, 실행에 필요한 설정(의존 요소), 실행파일/소프트웨어(프로그램)

도커 이미지에는 모든 요소들이 압축되어 준비되기 때문에 기타 자료들이 필요없다.

이미지는 특정 시점의 파일 시스템(디렉토리)를 저장한 압축 파일이라고 생각하면 된다.

컨테이너를 실행할 때 이미지 안에 있는 것들이 같이 실행된다.

### 2.2 이미지와 컨테이너

프로그램 : 디스크에 저장된 실행 가능한 소프트웨어

프로세스 : 프로그램이 실행된 상태로 리소스를 사용한다.

이미지와 컨테이너는 프로그램과 프로세스의 관계와 유사하다.

이미지는 저장공간을 차지하는 실행 가능한 소프트웨어, 이미지를 실행하면 컨테이너가 된다.

## 명령어 정리(Window)

```shell
# 현재 실행중인 모든 컨테이너 삭제
docker ps -aq | ForEach-Object {docker rm -f $_}

# 현재 도커 클라이언트/서버 버전 확인
docker version

# 현재 도커 정보 확인 
docker info

# 컨테이너 실행
docker run (옵션들) (이미지이름)

# 컨테이너 삭제(실행중인 컨테이너는 -f 옵션 사용)
docker rm 컨테이너 이름/id

# 이미지 조회 - 이미지 이름을 붙이면 해당 이미지만 조회할 수 있다.
docker images 또는 image ls (이미지이름)

# 이미지 실행 (-d는 백그라운드 실행 옵션)
docker run -d --name {컨테이너명} 이미지명

```